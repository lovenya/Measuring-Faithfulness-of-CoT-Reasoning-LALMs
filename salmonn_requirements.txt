module load StdEnv/2023
module load python/3.10

salloc --time=01:00:00 --gpus=nvidia_h100_80gb_hbm3_3g.40gb:1 --cpus-per-task=8 --mem=64G --account=rrg-ravanelm

module load StdEnv/2023 cuda/12.2 rust gcc arrow

source salmonn_env/bin/activate

export OMP_NUM_THREADS=1
export MKL_NUM_THREADS=1
export OPENBLAS_NUM_THREADS=1

export CUDA_LAUNCH_BLOCKING=1
export TORCH_USE_CUDA_DSA=1


python main.py --model salmonn --experiment baseline --dataset sakura-language --verbose
python main.py --model salmonn --experiment adding_mistakes --dataset mmar --num-samples 2 --num-chains 2 --verbose --restricted

python main.py --model salmonn --experiment paraphrasing --dataset mmar --num-samples 2 --num-chains 2 --verbose --restricted

python data_processing/create_restricted_dataset.py --model salmonn --dataset all --num-chains 3

activate

pip install torch torchvision torchaudio --extra-index-url https://download.pytorch.org/whl/cu121

pip install nltk

pip install peft==0.3.0 soundfile librosa transformers==4.28.0 sentencepiece==0.1.97 accelerate==0.20.3 bitsandbytes gradio==3.23.0 omegaconf